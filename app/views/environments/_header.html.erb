<%# 
  Partial que exibe o header do environment/course. Dois locals: environment
  e course. Caso não seja necessário exibir o course basta passar :course => nil
%>
<div id="environment-header" class="container_16 clearfix" style="background-color: <%= course ? "#" + course.color : "inherited" %>">
  <% if environment %>
    <div class="avatar grid_3">
      <div class="frame"><%= image_tag environment.avatar.url(:thumb)  %></div>
    </div>
    <div class="name grid_12">
      <h3><%= link_to environment.name, environment_path(environment) %></h3>
    </div>
    <%= link_to "Editar", edit_environment_path(environment),
      :class => "edit grid_1" %>
  <% end %>

  <% if course %>
    <div class="grid_10">
      <h4><%= link_to course.name, environment_course_path(environment, course) %></h4>
    </div>
    <% if course.owner.eql? current_user %>
      <%= link_to "Editar", edit_environment_course_path(environment, course),
        :class => "grid_1 edit" %>
      <% if course.published? %>
        <%= link_to "Despublicar", unpublish_environment_course_path(environment, course),
          :class => "grid_1" %>
      <% elsif course.can_be_published? %>
        <%= link_to "Publicar", publish_environment_course_path(environment, course),
          :class => "grid_1" %>
      <% end %>
    <% else %>

      <% if (not current_user.get_association_with(course).nil?  and 
                 current_user.get_association_with(course).state.eql? "approved") %>
        <div class="grid_2">
          <%= link_to "Abandonar", unjoin_environment_course_path(environment, course),
            :class => "button" %>
        </div>
      <% end %>

    <% end %>
  <% end %>

</div><!-- end environment-header -->
