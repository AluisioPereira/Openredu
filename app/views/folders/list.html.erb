
<div id="all_content3">
<div id="col_content_video">
	<div id="breadcrumbs_video"><a href="<%=application_url%>">home</a> > <%= link_to 'redes', schools_path %> > <strong><a href="#"><%= @school.name%></a></strong></div>  
    <div id="title">ARQUIVOS</div>
<!-- LISTAGEM RECURSO ############################################################################################################################################## -->

<% if flash[:folder_error] %>
    <div id="error"><%= flash[:folder_error] %></div>
<% end %>




<div id="all_list">
	
<%= render :partial => "schools/school_info", :locals => {:school => @school}%>

<% if logged_in?  %>
<div id="actions_user">
	
	<%  if current_user.school_admin? @school %>
	   	 <%= link_to 'Criar diretório', new_school_folder_path(:id => @folder.id, :school_id => @school.id), :class => "share" %>
   		 <%= link_to 'Upload de arquivo', upload_school_folder_path(:id => @folder.id, :school_id => @school.id), :class => "share" %>
		 
		  <a href="#" onclick="ShowProperties();" class="share" id="rights_link">Permissions</a>
	    
	
	<% end %>
	<%# link_to 'RSS', { :controller => 'folder', :action => 'feed', :id => @folder.id, :access_key => @logged_in_user.rss_access_key }, { :class => 'small' } %>
	<%# link_to '(!)', { :controller => 'folder', :action => 'feed_warning' }, { :class => 'small', :style => 'margin-left:1px;' } %>

	
</div>
<% end %>
</div>  


<h3> <%= path(@folder, false) %></h3><a href="#" onclick="ShowList();" class="share" id="list_link" style="display:none;">back to folder</a>

	
<div id="list" style="position:relative; width: 100%; float: left;"><div>

<% if flash[:folder_error] %>
    <div id="error"><%= flash[:folder_error] %></div>
<% end %>

    <table class="grid">
        <tr>
            <th></th>
            <th width="239"><%= link_order 'Nome', 'name' %></th>
            <th width="82"><%= link_order 'Tamanho', 'filesize' %></th>
            <th><%= link_order 'Modificado em', 'date_modified' %></th>
            <th></th>
            <th></th>
        </tr>
<% if @folder_up %>
        <tr class="<%= cycle('even', 'odd') %>">
            <td><%= image_tag('folder.png') %></td>
            <td><%= @folder_up %></td>
            <td>--</td>
            <td>--</td>
            <td></td>
            <td></td>
        </tr>
<% end %>
<% @folders.each do |folder| %>
        <tr class="<%= cycle('even', 'odd') %>">
            <td><%= image_tag('folder.png') %></td>
            <td><%= link_to h(folder.name), school_folders_path(:id => folder, :school_id => @school.id) %></td>
            <td>--</td>
            <td><%= time_ago_in_words(folder.date_modified) %></td>
            <td>
    <% if @can_update %>
                <%= link_to image_tag('edit.png', :style => "border: 0"), rename_school_folder_path(:id => folder.id, :school_id => @school.id), { :title => 'Renomear esta pasta' } %>
    <% end %>
            </td>
            <td>
    <% if @can_delete %>
                <%= link_to image_tag('delete.png', :style => "border: 0"), destroy_folder_school_folder_path(:id => folder.id, :school_id => @school.id), { :title => 'Remover esta pasta', :confirm => "Todos os arquivos e subpastas serão removidos.\nDeseja continuar?" } %>
    <% end %>
            </td>
            <td></td>
        </tr>
<% end %>
<% @myfiles.each do |myfile| %>
        <tr class="<%= cycle('even', 'odd') %>">
            <td><%= image_tag('file.png') %></td>
            <td><%= link_to h(myfile.attachment_file_name), download_school_folder_path(:id => @folder.id, :file_id => myfile.id)%></td>
            <td><%= myfile.attachment_file_size %> KB</td>
            <td><%= time_ago_in_words(myfile.attachment_updated_at) %></td>
            <td>
    <% if @can_update %>
                <%# link_to image_tag('edit.png', :style => "border: 0"), rename_school_folder_path(:id => @folder.id, :school_id => @school.id), { :title => 'Rename this file' } %>
    <% end %>
            </td>
            <td>
    <% if @can_delete %>
                <%= link_to image_tag('delete.png', :style => "border: 0"), destroy_file_school_folder_path(:id => @folder.id, :file_id => myfile.id, :school_id => @school.id), { :title => 'Remover este arquivo', :confirm => 'Tem certeza?' } %>
    <% end %>
            </td>
        </tr>
<% end %>
    </table>
</div></div>

<% reset_cycle %>
<%  if current_user.school_admin? @school %>
<div id="folder_rights" style="display:none;position:relative;"><div>
    <% form_tag :action => 'update_permissions', :id => params[:id] do %>
        <table>
            <tr>
                <th></th>
                <th></th>
                <th class="rights">Create</th>
                <th class="rights">Read</th>
                <th class="rights">Update</th>
                <th class="rights">Delete</th>
            </tr>
    <% Group.find(:all, :order => 'name').each do |group| %>
            <tr class="<%= cycle('even', 'odd') %>">
        <% disabled = group.is_the_administrators_group? %>
        <% if disabled %>
                <td><%= image_tag('group_grey.png') %></td>
                <td style="color:#818181;"><%= h(group.name) %></td>
        <% else %>
                <td><%= image_tag('group.png') %></td>
                <td><%= h(group.name) %></td>
        <% end %>
                <td class="rights"><%= CRUD_check_box('create', group.id, controller.folder_id, disabled) %></td>
                <td class="rights"><%= CRUD_check_box('read', group.id, controller.folder_id, disabled) %></td>
                <td class="rights"><%= CRUD_check_box('update', group.id, controller.folder_id, disabled) %></td>
                <td class="rights"><%= CRUD_check_box('delete', group.id, controller.folder_id, disabled) %></td>
            </tr>
    <% end %>
        </table>
        <br>
        <%= submit_tag 'Save' %> <%= check_box('update_recursively', 'checked', {}, 'yes', 'no') %> Apply changes to subfolders
    <% end %>
</div></div>
<% end %>
	
	
	
	
	 
</div>



</div>

</div>








   









