<script type="text/javascript" charset="utf-8">
//<![CDATA[
$(document).ready(function(){
  $("#course_path").bind('keyup blur', function(e){
    var slug = $(this).slug()
    $(this).val(slug);
  })

  $("#course_path").bind('keyup blur', function(){
    var slug = $(this).slug()
    $("#url_preview .course").html(slug);
  })

  $("#course_name").bind('keyup blur', function(e){
    var slug = $(this).slug()
    $("#course_path").val(slug);
    $("#url_preview .course").html(slug);
  })

})
//]]>
</script>

<%= render :partial => 'courses/new/sidebar' %>
<div class="main grid_12 omega big-col">
  <ol id="breadcrumbs" class="clearfix">
    <li>
      <%= link_to 'Home', home_user_path(current_user),
        :class => 'replacement home icon icon-redu_r8_c227_s1' %>
    </li>
    <li>
      <%= link_to @environment.name, environment_path(@environment),
        :class => 'replacement icon icon-redu_r8_c217_s1' %>
    </li>
    <li>
      <%= link_to @course.name, environment_course_path(@environment, @course),
        :class => 'icon icon-redu_r8_c313_s1' %>
    </li>
  </ol>
  <%= render :partial => 'courses/new/header' %>
  <div id="course-manage" class="body">
    <div class="header">
      <h4>Gerenciamento</h4>
      <span class="counter">Informações gerais do Curso</span>
    </div>
    <%
      fake_tabs ["Informações", edit_environment_course_path(@environment, @course), {:class => 'icon'}],
        ["Membros", admin_members_environment_course_path(@environment, @course), {:class => 'icon'}],
        ["Moderação", admin_members_requests_environment_course_path(@environment, @course), {:class => 'icon'}],
        ["Disciplinas", admin_spaces_environment_course_path(@environment, @course), {:class => 'icon'}] do
    %>
      <% form_for @course,
        :url => environment_course_path(@environment, @course),
        :html => { :class => "common" } do |f| %>
        <%= render :partial => 'courses/new/form', :locals => { :f => f, :edit => true } %>
        <%= f.submit "Salvar alterações" %>
        <% if @course.published? %>
          <%= link_to 'Despublicar', unpublish_environment_course_path(@environment, @course),
            :confirm => 'Você tem certeza que deseja deixar este curso invisível?',
            :class => "vanilla cancel" %>
        <% else %>
          <%= link_to 'Publicar', publish_environment_course_path(@environment, @course),
            :confirm => 'Você tem certeza que deseja deixar este curso visível?' %>
        <% end %>
        <%= link_to 'Remover', environment_course_path(@environment, @course),
          :confirm => 'Você tem certeza que deseja remover este curso?', :method => :delete,
          :class => "vanilla remove" %>
      <% end %>
    <% end %>
  </div>
</div>
