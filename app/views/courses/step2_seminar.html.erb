<script type="text/javascript">
	function youtubePreview(textfield){
		regex = /youtube\.com\/watch\?v=([A-Za-z0-9._%-]*)[&\w;=\+_\-]*/;

		id = textfield.value.match(regex)
		if (id != null) {
			youtube_id = id[1];
			//alert(youtube_id)
			url = "http://www.youtube.com/v/" + youtube_id + "&hl=en&fs=1";
			
			jQuery('#yt_preview_param').attr("value",url);
			jQuery('embed').attr("src",url);
			jQuery('#youtube_preview').show();
			
		} 
			
	}
	
	function switchCourseFields(fieldType){
		if (fieldType == 1) {
			document.getElementById("upload_resource_field").style.display = "block";
			document.getElementById("external_resource_field").style.display = "none";
		} else {
			document.getElementById("upload_resource_field").style.display = "none";
			document.getElementById("external_resource_field").style.display = "block";
		}
		
	}
	
	function removeField(link){
		jQuery(link).parent("fieldset:first").hide()
		jQuery(link).siblings("input[type=hidden]:first").val("1")
	}
	
	function add_fields(link, association, content) {
		var new_id = new Date().getTime();
		var regexp = new RegExp("new_" + association, "g")
		jQuery(link).before("<fieldset>" + content.replace(regexp, new_id) + "</fieldset>");
	}

</script>



<div class="grid_16">
<div id="breadcrumbs">
		<% if @school %>
	<a href="<%=application_url%>">início</a> > <a href="#">redes</a> > <%= link_to @school.name, @school %> > nova aula
	<% else %>
	<a href="<%=application_url%>">início</a> > <a href="#">ensinar</a> > nova aula
	<%end %>
	
	 </div>

<%= render(:partial => "schools/school_info", :locals=>{:show => false}) if @school%>

<h3 class="call">Nova vídeo-aula </h3>

<table class="booking_steps" cellpadding="0" cellspacing="0">
							<tbody><tr>
								<td><span class="book_step"><span><em>1</em>Informações Gerais</span></span></td>
								<td class="spacer">&nbsp;</td>
								<td><span class="book_step current"><span><em>2</em>Editor de Aula</span></span></td>
								<td class="spacer">&nbsp;</td>
								<td><span class="book_step disabled"><span><em>3</em>Publicação</span></span></td>
							</tr>
						</tbody></table>
</div>

	
<% form_for :seminar, @seminar, :url => { :action => "create" }, :html => { :multipart => true } do |f| %>
<%= f.error_messages %>

<%= hidden_field_tag("step", "2", options = {})%>
	<%= hidden_field_tag("school_id", @school.id) if @school %>
	
<div class="grid_6">
	
<fieldset>
	<legend>Vídeo</legend>

  <%# f.radio_button :external_resource_type, :slideshare, {:onchange => "switchCourseFields(2);" }%>
  <%# f.label :external_resource_type_slideshare, "Slideshare", :class => "inline"  %>	
  <%= f.radio_button :external_resource_type, :youtube, {:onchange => "switchCourseFields(2);"} %>
  <%= f.label :external_resource_type_youtube, "Youtube", :class => "inline"  %>
  <%= f.radio_button :external_resource_type, :upload, {:onchange => "switchCourseFields(1);"} %>
  <%= f.label :external_resource_type_upload, "Upload", :class => "inline"  %><br/><br/>	

  <div id="upload_resource_field" style="display:none;">
  <%= f.label :media, "Upload de vídeo" %>
  <%= f.file_field :media  %>
  (tamanho máximo: 50MB)
 	</div>	
  <div id="external_resource_field" style="display:block;">
  <%= f.label :external_resource, "Link do Vídeo" %>
  <%= f.text_field :external_resource, :onkeyup => "youtubePreview(this)"  %>
  </div>
	

  
</fieldset>	
</div>	

<div class="grid_6">

<div id="youtube_preview" style="display: none;">
<object width="520" height="344">
<param name="movie" value="none" id="yt_preview_param">
</param><param name="allowFullScreen" value="true">
</param><param name="allowscriptaccess" value="always">
</param><embed src="none" 
type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="520" height="344">
</embed></object> 
</div>

</div>	




<div class="grid_16">
<%# render :partial => 'attachment_form', :locals => {:f => f, :course => @seminar}%>


<%= link_to '< Anterior', new_course_path(:step => '1'), :class => "button" %> 
<%= f.submit 'Próximo >', :class => "button" %> 

<br><%= link_to 'Cancelar', cancel_courses_path, :confirm => "Tem certeza que deseja sair do editor de aulas?" %>
</div>

<% end %>

</div>

	
	
</div>
