 <script>
 	function saveDraft(opt, opt_param){
        var theform = document.getElementById('exam_form');
		var theattribute = document.getElementById('sbt_opt');
		
		// Atributo opcional (usado para passar o id da questão para editar)
		if (opt_param) {
			var theoptattribute = document.getElementById('opt_param');
			theoptattribute.value = opt_param;
		}
		theattribute.value = opt;
		theform.submit();
    }
	
	function publishExam() {
		var confirm_msg = "Uma vez publicado, o exame não poderá ser editado nem removido. Deseja continuar?";
		if (confirm(confirm_msg)) {
			saveDraft(5);
		} 
		
	}
	
 </script>
 
<div id="all_content3">
<div id="col_content">
	<div id="breadcrumbs"><a href="<%=application_url%>">home</a> > <a href="#">ensinar</a> > <a href="#">exames</a> > novo exame </div>
   	
 <% form_for :exam, @exam, :url => { :action => "create" },  :html => {:id => 'exam_form'} do |f| %>
 
 <div id="title">NOVO EXAME - PASSO 2
  <%= f.error_messages %>
	
    <div id="task_bar_exames">
		
		<%= link_to_function 'Nova questão', 'saveDraft(1)' %> | 
 		<%= link_to_function 'Adicionar questão', 'saveDraft(2)' %> 
 		<%# link_to_function '| Adicionar materiais', 'saveDraft(3)' %>
	
	</div>
 
 </div>

 
  <%= hidden_field_tag("step", "2", options = {})%>
  <%= hidden_field_tag("exam_type", "simple", options = {})%>
  <%= hidden_field_tag('sbt_opt', 0) %>
  <%= hidden_field_tag('opt_param', 0) %>
  <%= f.hidden_field(:id, :value => @exam.id) %>
 
 <BR><hr><BR>
 
 
<!--
Materiais: <br/>
-->
<% if @exam.resources && @exam.resources.length > 0 %>

 <%= render :partial => 'resources/item', :collection => @exam.resources, :as => :resource %> 
 <% else %>
 <!--
 Não há materiais associados. 
 -->
 <% end %>
<!--
 <br/><BR>
<hr>
-->

 <div id="questions" style="min-height: 100px;">
 
 
 
 
 
 <% if @exam.questions && @exam.questions.length > 0 %>
 
 	
 
 <%= render :partial => 'exams/question_show', :collection => @exam.questions, :as => :question, :locals => {:form => f, :exam => @exam} %> 
 
 
 <% else %>
 Não há questões nesse teste ainda. 
 Clique em "Adicionar Questão" para adicionar uma questão a 
 partir do banco de dados ou "Nova Questão" para criar uma questão.
 
 <% end %>
 </div>
 
 <!-- drop_receiving_element('questions',                             # The id of the receiving element
  :with   => "'question=' + (element.id.split('_').last())",     # The query string parameters
  :url    => {:action=>:trash_comment}                          # The action to call
 )-->
 
 <%= sortable_element 'questions',
:url => { :action => "sort_question" , :id => @exam },
:complete => visual_effect(:highlight, 'questions'),
 :tag => 'div', :scroll => true
%>
  
 
  
<%= link_to '< Anterior', new_exam_path(:step => '1'), :class => "button" %> 
<%= f.submit 'Próximo >' %> 


  <%= link_to 'Descartar e Voltar', cancel_exams_path, :confirm => "Tem certeza que deseja sair do editor de exames?" %>

  
  
 <% end %>
 

</div>

</div>
 
 
 
 
 
 
 
 
 