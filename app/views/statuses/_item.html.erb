<%# Status e suas respostas  %>

<% if item.type.eql? 'Log' %>
  <%= render "statuses/log", :log => item %>
<% elsif item.type.eql? 'CompoundLog' %>
    <% if item.logeable_type.eql? 'Friendship' %>
      <%= render 'statuses/friendship_compound', :compound => item %>
    <% elsif item.logeable_type.eql? 'UserCourseAssociation' %>
      <%= render 'statuses/uca_compound', :compound => item %>
    <% end %>
<% else %>
  <% if item.statusable_type.eql?('Lecture') && item.type == 'Help' %>
    <li id="status-<%= item.id %>">
      <hr class="list-separator">
      <div class="status log">
        <div class="context">
          <%= link_to item.statusable.name, space_subject_lecture_path(item.statusable.subject.space, item.statusable.subject, item.statusable), :class => "text-replacement context-icon  icon-subject-gray_32_34-before" %>
          <span class="legend">
            <%= item.statusable.subject.space.course.environment.name %> >
            <%= item.statusable.subject.name  %>
            <%= item.statusable.subject.space.name %>
          </span>
          <%= link_to item.statusable.name, space_subject_lecture_path(item.statusable.subject.space, item.statusable.subject, item.statusable) %>
        </div>
        <div class="subject">
          <div class="subject-info icon-request-help-lightorange_16_18-before icon-log">
            <%= render "statuses/user_image", :item => item %>
            <%= render "statuses/user_name", :item => item %>
            <span class="action">pediu <span class="help">ajuda</span> na Aula</span>
            <%= link_to item.statusable.name, space_subject_lecture_path(item.statusable.subject.space, item.statusable.subject, item.statusable) %>
            <% if can? :manage, item %>
              <%= link_to 'Fechar',
                status_path(item),
                :method => :delete,
                :remote => true,
                :class => 'icon-close icon-small icon-close-gray_16_16 replacement remove-help-request',
                :confirm => 'Ao remover o pedido de ajuda, as respostas também serão apagadas. Deseja removê-lo?'%>
          <% end %>
            <%= render :partial => 'statuses/timeago', :locals => { :item => item } %>
          </div>
        </div>
        <div class="subject-content">
          <%= render 'statuses/resource', :status => item %>
          <%= render 'statuses/responses', :status => item %>
          <%= render 'statuses/actions', :status => item %>
          <%= render :partial => 'statuses/create_response',
            :locals => { :in_response_to => item }%>
        </div>
      </div>
    </li>
  <% elsif item.statusable_type.eql?('Lecture') %>
    <li id="status-<%= item.id %>">
      <hr class="list-separator">
      <div class="status">
        <div class="context">
          <%= link_to item.statusable.name, space_subject_lecture_path(item.statusable.subject.space, item.statusable.subject, item.statusable), :class => "text-replacement context-icon icon-lecture-gray_32_34-before" %>
          <span class="legend">
            <%= item.statusable.subject.space.course.environment.name %> >
            <%= item.statusable.subject.name  %> >
            <%= item.statusable.subject.space.name %>
          </span>
          <%= link_to item.statusable.name,space_subject_lecture_path(item.statusable.subject.space, item.statusable.subject, item.statusable) %>
        </div>
        <div class="subject">
          <%= render "statuses/user_image", :item => item %>
          <div class="subject-info icon-<%= item.user ? role_at(item.user, item.statusable) : "member" %>-gray_16_18-before ">
            <%= render "statuses/user_name", :item => item %>
            <span class="action">comentou no mural da aula </span><%= link_to item.statusable.name, space_subject_lecture_path(item.statusable.subject.space, item.statusable.subject, item.statusable) %>
            <% if can? :manage, item %>
              <%= link_to 'Fechar',
                status_path(item),
                :method => :delete,
                :remote => true,
                :class => 'icon-close icon-small icon-close-gray_16_16 replacement',
                :confirm => 'Ao remover o comentário, todas as respostas serão apagadas. Deseja removê-lo?' %>
          <% end %>
            <%= render :partial => 'statuses/timeago', :locals => { :item => item } %>
          </div>
        </div>
        <div class="subject-content">
        <%= render 'statuses/resource', :status => item %>
        <%= render 'statuses/responses', :status => item %>
        <%= render 'statuses/actions', :status => item %>
        <%= render :partial => 'statuses/create_response',
          :locals => { :in_response_to => item }%>
        </div>
      </div>
    </li>
  <% elsif item.statusable_type.eql?('Space') %>
    <li id="status-<%= item.id %>">
      <hr class="list-separator">
      <div class="status">
        <div class="context">
          <%= link_to item.statusable.name, mural_space_path(item.statusable), :class => "text-replacement context-icon icon-space-gray_32_34-before" %>
          <span class="legend">
            <%= item.statusable.course.environment.name %> >
            <%= item.statusable.course.name %>
          </span>
          <%= link_to item.statusable.name, mural_space_path(item.statusable), :class =>"context-link" %>
        </div>
        <div class="subject">
          <%= render "statuses/user_image", :item => item %>
          <div class="subject-info icon-<%= item.user ? role_at(item.user, item.statusable) : "member" %>-gray_16_18-before ">
            <%= render "statuses/user_name", :item => item %>
            <span class="action">comentou na disciplina  <%= link_to item.statusable.name, mural_space_path(item.statusable) , :class => "icon-space-gray_16_18-before" %>
            </span>
            <% if can? :manage, item %>
              <%= link_to 'Fechar',
                status_path(item),
                :method => :delete,
                :remote => true,
                :class => 'icon-close icon-small icon-close-gray_16_16 replacement',
                :confirm => 'Ao remover o comentário, todas as respostas serão apagadas. Deseja removê-lo?' %>
            <% end %>
            <%= render :partial => 'statuses/timeago', :locals => { :item => item } %>
          </div>
        </div>
        <div class="subject-content">
          <%= render 'statuses/resource', :status => item %>
          <%= render 'statuses/responses', :status => item %>
          <%= render 'statuses/actions', :status => item %>
          <%= render :partial => 'statuses/create_response',
            :locals => { :in_response_to => item }%>
        </div>
      </div>
    </li>
  <% else %>
    <li id="status-<%= item.id %>">
      <hr class="list-separator">
      <div class="status without-context">
        <div class="subject">
             <%= render "statuses/user_image", :item => item %>
          <div class="subject-info">
            <% if item.user %>
              <%= link_to item.user.display_name, user_path(item.user), :class => "link-name" %>
            <% else %>
              <span class="link-name">[Usuário Removido]</span>
            <% end %>

            <span class="action">
            <% if item.statusable_type.eql?('User') %>
              <% unless item.statusable.eql?(item.user) %>
                comentou no mural de <%= link_to item.statusable.display_name, show_mural_user_path(item.statusable) %>
              <% else %>
                comentou no <%= link_to "seu próprio mural", show_mural_user_path(item.user) %>
              <% end %>
            <% end %>
            </span>
            <% if can? :manage, item %>
                <%= link_to 'Fechar',
                  status_path(item),
                  :method => :delete,
                  :remote => true,
                  :class => 'icon-close icon-small icon-close-gray_16_16 replacement',
                  :confirm => 'Ao remover este comentário, as respostas também serão excluídas. Deseja removê-lo?'%>
            <% end %>
            <%= render :partial => 'statuses/timeago', :locals => { :item => item } %>
          </div>
        </div>
        <div class="subject-content">
          <%= render 'statuses/resource', :status => item %>
          <%= render 'statuses/responses', :status => item %>
          <%= render 'statuses/actions', :status => item %>
          <%= render :partial => 'statuses/create_response',
          :locals => { :in_response_to => item } %>
        </div>
      </div>
    </li>
  <% end %>
<% end %>
