(function(b){var a;b.rails=a={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type])",disableSelector:"input[data-disable-with], button[data-disable-with], textarea[data-disable-with]",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled",requiredInputSelector:"input[name][required],textarea[name][required]",fileInputSelector:"input:file",CSRFProtection:function(d){var c=b('meta[name="csrf-token"]').attr("content");if(c){d.setRequestHeader("X-CSRF-Token",c)}},fire:function(f,c,e){var d=b.Event(c);f.trigger(d,e);return d.result!==false},confirm:function(c){return confirm(c)},ajax:function(c){return b.ajax(c)},handleRemote:function(f){var h,d,g,c=f.data("type")||(b.ajaxSettings&&b.ajaxSettings.dataType);if(a.fire(f,"ajax:before")){if(f.is("form")){h=f.attr("method");d=f.attr("action");g=f.serializeArray();var e=f.data("ujs:submit-button");if(e){g.push(e);f.data("ujs:submit-button",null)}}else{h=f.data("method");d=f.attr("href");g=null}a.ajax({url:d,type:h||"GET",data:g,dataType:c,beforeSend:function(j,i){if(i.dataType===undefined){j.setRequestHeader("accept","*/*;q=0.5, "+i.accepts.script)}return a.fire(f,"ajax:beforeSend",[j,i])},success:function(j,i,k){f.trigger("ajax:success",[j,i,k])},complete:function(j,i){f.trigger("ajax:complete",[j,i])},error:function(k,i,j){f.trigger("ajax:error",[k,i,j])}})}},handleMethod:function(g){var d=g.attr("href"),i=g.data("method"),e=b("meta[name=csrf-token]").attr("content"),h=b("meta[name=csrf-param]").attr("content"),f=b('<form method="post" action="'+d+'"></form>'),c='<input name="_method" value="'+i+'" type="hidden" />';if(h!==undefined&&e!==undefined){c+='<input name="'+h+'" value="'+e+'" type="hidden" />'}f.hide().append(c).appendTo("body");f.submit()},disableFormElements:function(c){c.find(a.disableSelector).each(function(){var d=b(this),e=d.is("button")?"html":"val";d.data("ujs:enable-with",d[e]());d[e](d.data("disable-with"));d.attr("disabled","disabled")})},enableFormElements:function(c){c.find(a.enableSelector).each(function(){var d=b(this),e=d.is("button")?"html":"val";if(d.data("ujs:enable-with")){d[e](d.data("ujs:enable-with"))}d.removeAttr("disabled")})},allowAction:function(c){var d=c.data("confirm"),e=false,f;if(!d){return true}if(a.fire(c,"confirm")){e=a.confirm(d);f=a.fire(c,"confirm:complete",[e])}return e&&f},blankInputs:function(h,e,g){var d=b(),f,c=e||"input,textarea";h.find(c).each(function(){f=b(this);if(g?f.val():!f.val()){d=d.add(f)}});return d.length?d:false},nonBlankInputs:function(d,c){return a.blankInputs(d,c,true)},stopEverything:function(c){c.stopImmediatePropagation();return false},callFormSubmitBindings:function(d){var c=d.data("events"),e=true;if(c!==undefined&&c.submit!==undefined){b.each(c.submit,function(f,g){if(typeof g.handler==="function"){return e=g.handler(g.data)}})}return e}};if("ajaxPrefilter" in b){b.ajaxPrefilter(function(c,e,d){a.CSRFProtection(d)})}else{b(document).ajaxSend(function(c,d){a.CSRFProtection(d)})}b(a.linkClickSelector).live("click.rails",function(d){var c=b(this);if(!a.allowAction(c)){return a.stopEverything(d)}if(c.data("remote")!==undefined){a.handleRemote(c);return false}else{if(c.data("method")){a.handleMethod(c);return false}}});b(a.formSubmitSelector).live("submit.rails",function(h){var f=b(this),g=f.data("remote")!==undefined,d=a.blankInputs(f,a.requiredInputSelector),c=a.nonBlankInputs(f,a.fileInputSelector);if(!a.allowAction(f)){return a.stopEverything(h)}if(d&&a.fire(f,"ajax:aborted:required",[d])){return !g}if(g){if(c){return a.fire(f,"ajax:aborted:file",[c])}if(!b.support.submitBubbles&&a.callFormSubmitBindings(f)===false){return a.stopEverything(h)}a.handleRemote(f);return false}else{setTimeout(function(){a.disableFormElements(f)},13)}});b(a.formInputClickSelector).live("click.rails",function(e){var d=b(this);if(!a.allowAction(d)){return a.stopEverything(e)}var c=d.attr("name"),f=c?{name:c,value:d.val()}:null;d.closest("form").data("ujs:submit-button",f)});b(a.formSubmitSelector).live("ajax:beforeSend.rails",function(c){if(this==c.target){a.disableFormElements(b(this))}});b(a.formSubmitSelector).live("ajax:complete.rails",function(c){if(this==c.target){a.enableFormElements(b(this))}})})(jQuery);jQuery(function(){$(".flash-message").parent().next().css("marginTop","10px");$(".flash-message .close-flash").click(function(a){$(this).parent().slideToggle();$("#content").css("marginTop","20px");a.preventDefault()});$("#nav-account").hover(function(){$(this).find(".username").toggleClass("hover");$(this).find("ul").toggle()});$("a.reply-status, .cancel",".statuses").live("click",function(a){$(this).parents("ul:first").next(".create-response").slideToggle();$(this).parents(".create-response:first").slideToggle();a.preventDefault()});$(".responses",".statuses").each(function(a,b){$(this).find("> ol > li:gt(2)").hide();$(this).find(".toggle-statuses .qty").html($(this).find("ol > li").length)});$(".toggle-statuses",".statuses").live("click",function(a){$(this).prev().find("> li:hidden").slideDown();a.preventDefault()});$("input[type=submit], .cancel, .char-limit",".inform-my-status").hide();$(".inform-my-status textarea").live("focus",function(a){$(this).parents("form").find("input[type=submit], .cancel, .char-limit").fadeIn()});$(".inform-my-status textarea").live("blur",function(a){$(this).parents("form").find("input[type=submit], .cancel, .char-limit").fadeOut()});$("input[type=text], input[type=password], input[type=radio], input[type=checkbox]","form.highlightable").focus(function(){var a=$(this).attr("id")||null;if(a){$("label[for="+a+"]").addClass("focus")}}).blur(function(){var a=$(this).attr("id")||null;if(a){$("label[for="+a+"]").removeClass("focus")}});jQuery.fn.slug=function(){var c=$(this);var a=stripAccent(c.val());var b=a.replace(/\s+/g,"-");return b.replace(/[^a-zA-Z0-9\-]/g,"").toLowerCase()};$(".new-resource li").live("hover",function(){var a="<strong>"+$(this).html()+"</strong>";a+=$(this).find("a").attr("title");$(".new-resource .explanation").html(a)});$("#new_subject .new-resource li a").live("click",function(){$("#new_subject .new-resource li").removeClass("selected");$(this).parents("li:first").addClass("selected")});$(".expand, .unexpand","#space-subjects .subjects").click(function(){$(this).toggleClass("expand");$(this).toggleClass("unexpand");$(this).parents("li:first").toggleClass("open");$(this).next().slideToggle("fast")});$("#resource .student-actions .action-help").click(function(a){$(this).parents("li:first").toggleClass("selected");$(".statuses-wrapper","#resource").slideToggle();a.preventDefault()});$("#seminar_external_resource").live("change",function(){youtubePreview($("#seminar_external_resource"))});$("table.common tr:even:not(.invite):not(.message)").addClass("odd");$("#select_all").change(function(b){var a=$(this);if(a.is(":checked")){$("input[type=checkbox].autoCheck").attr("checked",true)}else{$("input[type=checkbox].autoCheck").attr("checked",false)}return true});$("#global-courses .filters .filter").each(function(){var a=$(this).find("input");if(a.is(":checked")){$(this).addClass("checked")}});$("#global-courses .filters .filter").click(function(){var a=$(this).find("input[type=checkbox]");if(a.is(":checked")){$(this).removeClass("checked");a.attr("checked","")}else{$(this).addClass("checked");a.attr("checked","checked")}});$("#global-courses .courses .expand").live("click",function(){$(this).toggleClass("unexpand");$(this).parents(":first").next().slideToggle()});$(".parent-height").height(function(b,a){$(this).height($(this).parent().height())});$("#user_email").click(function(){$("#user_email_confirmation").slideDown();$("#user_email_confirmation").prev().slideDown()});$("#user_email_confirmation").blur(function(){email_val=$("#user_email").val();confirmation_val=$(this).val();if(email_val!=confirmation_val){$("#user_email_confirmation-error").remove();$(this).after('<p id="user_email_confirmation-error" class="errorMessageField">Os e-mails digitados não são iguais.</p>')}else{$("#user_email_confirmation-error").remove()}});$(".tiptip").tipTip();$(".form-common").ajaxComplete(function(){$(".tiptip").tipTip()});$(".form-common .tiptip").each(function(){var a=$(this).next("label");a.prepend($(this))});$(".tiptip-lite").each(function(){var a=$("<span class='tiptip question-blue_12_12'/>");a.attr("title",$(this).attr("title"));a.tipTip();$(this).after(a);a.position({my:"left center",at:"right center",of:$(this),offset:"10px 0",})});$("#space-materials .new-folder .button").click(function(a){$(this).next(".new-folder-inner").toggle();a.preventDefault()});$(".form-common, .form-loader").live("ajax:before",function(){$(this).find("input[type=submit]").loadingStart()});$(".form-common, .form-loader").live("ajax:complete",function(){$(this).find("input[type=submit]").loadingComplete()});$("a[data-remote=true]").live("ajax:before",function(){$(this).addClass("link-loading")});$("a[data-remote=true]").live("ajax:complete",function(){$(this).removeClass("link-loading")});$.fn.loadingStart=function(){return this.each(function(){$bt=$(this);$bt.addClass("bt-loading")})};$.fn.loadingComplete=function(){return this.each(function(){$bt=$(this);$bt.removeClass("bt-loading")})};$.fn.loadingToggle=function(){return this.each(function(){$bt=$(this);if($bt.hasClass("bt-loading")){$bt.loadingComplete()}else{$bt.loadingStart()}})}});function limitChars(c,a,b){var e=$("."+c).val();var d=e.length;if(d>a){$("."+c).val(e.substr(0,a));return false}else{$("."+b).html(a-d);return true}}function stripAccent(d){var c=[{re:/[\xC0-\xC6]/g,ch:"A"},{re:/[\xE0-\xE6]/g,ch:"a"},{re:/[\xC8-\xCB]/g,ch:"E"},{re:/[\xE8-\xEB]/g,ch:"e"},{re:/[\xCC-\xCF]/g,ch:"I"},{re:/[\xEC-\xEF]/g,ch:"i"},{re:/[\xD2-\xD6]/g,ch:"O"},{re:/[\xF2-\xF6]/g,ch:"o"},{re:/[\xD9-\xDC]/g,ch:"U"},{re:/[\xF9-\xFC]/g,ch:"u"},{re:/[\xE7]/g,ch:"c"},{re:/[\xC7]/g,ch:"C"},{re:/[\xD1]/g,ch:"N"},{re:/[\xF1]/g,ch:"n"}];for(var b=0,a=c.length;b<a;b++){d=d.replace(c[b].re,c[b].ch)}return d}function youtubePreview(a){regex=/youtube\.com\/watch\?v=([A-Za-z0-9._%-]*)[&\w;=\+_\-]*/;id=a.val().match(regex);if(id!=null){youtube_id=id[1];url="http://www.youtube.com/v/"+youtube_id+"&hl=en&fs=1";jQuery("#yt_preview_param").attr("value",url);jQuery("embed").attr("src",url);jQuery("#youtube_preview").show()}else{$("#youtube_preview").hide()}}function switchCourseFields(a){if(a==1){$("#upload_resource_field").show();$("#external_resource_field").hide();$("#youtube_preview").hide();$("#seminar_submit").hide()}else{$("#upload_resource_field").hide();$("#external_resource_field").show();youtubePreview($("#seminar_external_resource"));$("#seminar_submit").show()}}(function(a){a.fn.tipTip=function(c){var g={activation:"hover",keepAlive:false,maxWidth:"200px",edgeOffset:3,defaultPosition:"bottom",delay:400,fadeIn:200,fadeOut:200,attribute:"title",content:false,enter:function(){},exit:function(){}};var e=a.extend(g,c);if(a("#tiptip_holder").length<=0){var b=a('<div id="tiptip_holder" style="max-width:'+e.maxWidth+';"></div>');var d=a('<div id="tiptip_content"></div>');var f=a('<div id="tiptip_arrow"></div>');a("body").append(b.html(d).prepend(f.html('<div id="tiptip_arrow_inner"></div>')))}else{var b=a("#tiptip_holder");var d=a("#tiptip_content");var f=a("#tiptip_arrow")}return this.each(function(){var i=a(this);if(e.content){var l=e.content}else{var l=i.attr(e.attribute)}if(l!=""){if(!e.content){i.removeAttr(e.attribute)}var h=false;if(e.activation=="hover"){i.hover(function(){k()},function(){if(!e.keepAlive){j()}});if(e.keepAlive){b.hover(function(){},function(){j()})}}else{if(e.activation=="focus"){i.focus(function(){k()}).blur(function(){j()})}else{if(e.activation=="click"){i.click(function(){k();return false}).hover(function(){},function(){if(!e.keepAlive){j()}});if(e.keepAlive){b.hover(function(){},function(){j()})}}}}function k(){e.enter.call(this);d.html(l);b.hide().removeAttr("class").css("margin","0");f.removeAttr("style");var y=parseInt(i.offset()["top"]);var p=parseInt(i.offset()["left"]);var v=parseInt(i.outerWidth());var A=parseInt(i.outerHeight());var x=b.outerWidth();var s=b.outerHeight();var w=Math.round((v-x)/2);var o=Math.round((A-s)/2);var n=Math.round(p+w);var m=Math.round(y+A+e.edgeOffset);var t="";var C="";var u=Math.round(x-12)/2;if(e.defaultPosition=="bottom"){t="_bottom"}else{if(e.defaultPosition=="top"){t="_top"}else{if(e.defaultPosition=="left"){t="_left"}else{if(e.defaultPosition=="right"){t="_right"}}}}var r=(w+p)<parseInt(a(window).scrollLeft());var q=(x+p)>parseInt(a(window).width());if((r&&w<0)||(t=="_right"&&!q)||(t=="_left"&&p<(x+e.edgeOffset+5))){t="_right";C=Math.round(s-13)/2;u=-12;n=Math.round(p+v+e.edgeOffset);m=Math.round(y+o)}else{if((q&&w<0)||(t=="_left"&&!r)){t="_left";C=Math.round(s-13)/2;u=Math.round(x);n=Math.round(p-(x+e.edgeOffset+5));m=Math.round(y+o)}}var z=(y+A+e.edgeOffset+s+8)>parseInt(a(window).height()+a(window).scrollTop());var B=((y+A)-(e.edgeOffset+s+8))<0;if(z||(t=="_bottom"&&z)||(t=="_top"&&!B)){if(t=="_top"||t=="_bottom"){t="_top"}else{t=t+"_top"}C=s;m=Math.round(y-(s+5+e.edgeOffset))}else{if(B|(t=="_top"&&B)||(t=="_bottom"&&!z)){if(t=="_top"||t=="_bottom"){t="_bottom"}else{t=t+"_bottom"}C=-12;m=Math.round(y+A+e.edgeOffset)}}if(t=="_right_top"||t=="_left_top"){m=m+5}else{if(t=="_right_bottom"||t=="_left_bottom"){m=m-5}}if(t=="_left_top"||t=="_left_bottom"){n=n+5}f.css({"margin-left":u+"px","margin-top":C+"px"});b.css({"margin-left":n+"px","margin-top":m+"px"}).attr("class","tip"+t);if(h){clearTimeout(h)}h=setTimeout(function(){b.stop(true,true).fadeIn(e.fadeIn)},e.delay)}function j(){e.exit.call(this);if(h){clearTimeout(h)}b.fadeOut(e.fadeOut)}}})}})(jQuery);